<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.2//EN" "http://www.w3.org/Graphics/SVG/1.2/DTD/svg12.dtd">
<svg xmlns="http://www.w3.org/2000/svg" version="1.2" baseProfile="full" xml:space="preserve" width="600" height="380">
<desc>Source file</desc>
<defs><style type="text/css">
<![CDATA[
rect { fill:#ffffff; } 
g { font-size: 10pt; font-family: Courier New; white-space: pre; }
]]>
</style></defs><g>
<rect x="0" y="0" width="100%" height="100%"/>
<text x="10" y="20"></text>
<text x="10" y="20"><tspan style="font-weight:bold;fill:#7f7f7f;">diff&#160;--git&#160;a/day_06_part_1.sql&#160;b/day_06_part_2.sql</tspan>
</text>
<text x="10" y="40"><tspan style="font-weight:bold;fill:#7f7f7f;">index&#160;a418182..7c82e8f&#160;100644</tspan>
</text>
<text x="10" y="60"><tspan style="font-weight:bold;fill:#7f7f7f;">---&#160;a/day_06_part_1.sql</tspan>
</text>
<text x="10" y="80"><tspan style="font-weight:bold;fill:#7f7f7f;">+++&#160;b/day_06_part_2.sql</tspan>
</text>
<text x="10" y="100"><tspan style="fill:#00cdcd;">@@&#160;-19,11&#160;+19,13&#160;@@</tspan>&#160;with&#160;answers&#160;as&#160;(
</text>
<text x="10" y="120">&#160;&#160;&#160;&#160;coalesce(max(line_number)&#160;filter&#160;(where&#160;line_value&#160;=&#160;'')&#160;over&#160;(order&#160;by&#160;line_number))&#160;as&#160;group_id
</text>
<text x="10" y="140">&#160;&#160;from&#160;day06.inputs,
</text>
<text x="10" y="160">&#160;&#160;lateral&#160;(select&#160;regexp_split_to_table(line_value,&#160;''))&#160;as&#160;answers(question)
</text>
<text x="10" y="180">),&#160;<tspan style="fill:#cd0000;">answer_counts</tspan><tspan style="fill:#00cd00;">all_yes</tspan>&#160;as&#160;(
</text>
<text x="10" y="200">&#160;&#160;select&#160;group_id,&#160;<tspan style="fill:#cd0000;">count(distinct&#160;question)&#160;as&#160;questions</tspan><tspan style="fill:#00cd00;">potential.question</tspan>
</text>
<text x="10" y="220">&#160;&#160;from&#160;answers
</text>
<text x="10" y="240">&#160;&#160;<tspan style="fill:#00cd00;">cross&#160;join&#160;lateral&#160;(select&#160;distinct&#160;a.question&#160;from&#160;answers&#160;a&#160;where&#160;question&#160;!=&#160;'')&#160;as&#160;potential(question)</tspan>
</text>
<text x="10" y="260">&#160;&#160;where&#160;answers.question&#160;!=&#160;''
</text>
<text x="10" y="280">&#160;&#160;group&#160;by&#160;<tspan style="fill:#cd0000;">group_id</tspan><tspan style="fill:#00cd00;">group_id,&#160;potential.question</tspan>
</text>
<text x="10" y="300"><tspan style="fill:#00cd00;">&#160;&#160;having&#160;count(*)&#160;filter&#160;(where&#160;answers.question&#160;=&#160;potential.question)&#160;=&#160;count(distinct&#160;passenger_id)</tspan>
</text>
<text x="10" y="320">)&#160;select&#160;concat('Day&#160;06&#160;-&#160;Part&#160;<tspan style="fill:#cd0000;">1:</tspan><tspan style="fill:#00cd00;">2:</tspan>&#160;',&#160;<tspan style="fill:#cd0000;">sum(questions))</tspan><tspan style="fill:#00cd00;">count(*))</tspan>
</text>
<text x="10" y="340">&#160;&#160;from&#160;<tspan style="fill:#cd0000;">answer_counts</tspan><tspan style="fill:#00cd00;">all_yes</tspan>
</text>
<text x="10" y="360">;
</text>
</g>
</svg>
<!-- SVG generated by ansifilter 2.15, http://www.andre-simon.de/ -->
